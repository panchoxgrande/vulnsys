<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Configuración del Sistema</h1>
        <div id="alert-container"></div>

        <form id="settings-form">

            <div class="card mb-4">
                <div class="card-header">Sistemas Operativos a Monitorear</div>
                <div class="card-body">
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="windows" id="os-windows"><label class="form-check-label" for="os-windows">Windows</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="linux" id="os-linux"><label class="form-check-label" for="os-linux">Linux</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="macos" id="os-macos"><label class="form-check-label" for="os-macos">macOS</label></div>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Guardar Configuración</button>
        </form>

        <div class="card mt-4">
            <div class="card-header">Generar Agente</div>
            <div class="card-body">
                <p>Genera un script de agente pre-configurado con la URL del servidor y el token de autenticación.</p>
                <a id="download-windows-agent" href="#" class="btn btn-primary">Descargar Agente para Windows</a>
                <a id="download-linux-agent" href="#" class-="btn btn-secondary">Descargar Agente para Linux</a>
            </div>
        </div>

        <div class="mt-4"><a href="index.html" class="btn btn-secondary">Volver al Panel</a></div>
    </div>

    <script>
        const API_BASE_URL = `http://${window.location.hostname}:5000`;
        const form = document.getElementById('settings-form');
        // ... (otros selectores)

        document.addEventListener('DOMContentLoaded', () => {
            // Cargar configuración actual
            fetch(`${API_BASE_URL}/api/settings`)
                .then(response => response.json())
                .then(data => {
                    // ... (poblar formulario)
                });

            // Configurar botones de descarga
            document.getElementById('download-windows-agent').addEventListener('click', (e) => {
                e.preventDefault();
                const serverIp = window.location.hostname;
                window.location.href = `${API_BASE_URL}/api/generate_agent?os=windows&server_ip=${serverIp}`;
            });
            document.getElementById('download-linux-agent').addEventListener('click', (e) => {
                e.preventDefault();
                const serverIp = window.location.hostname;
                window.location.href = `${API_BASE_URL}/api/generate_agent?os=linux&server_ip=${serverIp}`;
            });
        });

        form.addEventListener('submit', (e) => {
            // ... (lógica para guardar)
        });
        // ... (resto del script)
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>